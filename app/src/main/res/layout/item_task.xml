<?xml version="1.0" encoding="utf-8"?>
<!--
    This CardView acts as the root container for a single task item.
    - CardView provides a consistent look with rounded corners and shadow (elevation).
    - layout_width="match_parent" makes it take the full width of the RecyclerView.
    - layout_height="wrap_content" makes its height adjust based on its content.
-->
<androidx.cardview.widget.CardView
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/taskCard"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_marginHorizontal="8dp"
    android:layout_marginVertical="6dp"
    app:cardCornerRadius="12dp"
    app:cardElevation="4dp">

    <!--
        A ConstraintLayout is used inside the CardView to allow for complex
        and flexible positioning of child views relative to each other. This is
        key for handling the dynamic visibility of the image preview.
    -->
    <androidx.constraintlayout.widget.ConstraintLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content">

        <!--
            The ImageView for the task's image preview.
            - It is constrained to the bottom and end (right) of the parent CardView.
            - 'android:visibility="gone"' makes it hidden by default. It will be made
              visible programmatically in the TaskAdapter if the task has an image.
            - 'tools:visibility="visible"' is a design-time attribute that makes the view
              visible in the Android Studio previewer, which helps with layout design.
        -->
        <ImageView
            android:id="@+id/taskImagePreview"
            android:layout_width="60dp"
            android:layout_height="60dp"
            android:layout_margin="8dp"
            android:scaleType="centerCrop"
            android:visibility="gone"
            app:layout_constraintBottom_toBottomOf="parent"
            app:layout_constraintEnd_toEndOf="parent"
            tools:src="@tools:sample/avatars"
            tools:visibility="visible" />

        <!--
            This LinearLayout serves as the colored title bar for the task.
            - Its bottom is constrained to the TOP of the image preview. This is the
              critical constraint that prevents overlap and ensures the card expands
              vertically to fit the image.
            - The 'layout_marginBottom' creates a visual space between the title bar
              and the content area below it.
        -->
        <LinearLayout
            android:id="@+id/titleBar"
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_marginBottom="8dp"
            android:gravity="center_vertical"
            android:orientation="horizontal"
            android:paddingHorizontal="16dp"
            android:paddingVertical="8dp"
            app:layout_constraintBottom_toTopOf="@+id/taskImagePreview"
            app:layout_constraintEnd_toEndOf="parent"
            app:layout_constraintStart_toStartOf="parent"
            app:layout_constraintTop_toTopOf="parent"
            app:layout_constraintVertical_bias="0.0">

            <!-- The TextView for the task's title. 'layout_weight="1"' allows it to
                 fill all available space next to the delete button. -->
            <TextView
                android:id="@+id/taskTitle"
                android:layout_width="0dp"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:ellipsize="end"
                android:fontFamily="@font/zalando_sans_semi_expanded_black"
                android:maxLines="2"
                android:paddingVertical="8dp"
                android:textColor="@android:color/black"
                android:textSize="18sp"
                android:textStyle="bold"
                tools:text="This is a very long task title" />

            <!-- The delete button (trash can icon) for the task. -->
            <ImageButton
                android:id="@+id/deleteButton"
                android:layout_width="30dp"
                android:layout_height="30dp"
                android:layout_marginStart="8dp"
                android:background="?attr/selectableItemBackgroundBorderless"
                android:contentDescription="Delete Task"
                android:src="@android:drawable/ic_menu_delete"
                app:tint="@android:color/black" />
        </LinearLayout>

        <!--
            This LinearLayout holds the description and deadline text.
            - 'layout_height="0dp"' allows it to fill the constrained space.
            - It is constrained between the bottom of the titleBar and the bottom of the parent.
            - Its end is constrained to the start of the image preview, ensuring the text
              wraps and never overlaps with the image.
        -->
        <LinearLayout
            android:id="@+id/contentLayout"
            android:layout_width="0dp"
            android:layout_height="0dp"
            android:gravity="center_vertical"
            android:orientation="vertical"
            android:paddingHorizontal="16dp"
            android:paddingBottom="16dp"
            app:layout_constraintBottom_toBottomOf="parent"
            app:layout_constraintEnd_toStartOf="@id/taskImagePreview"
            app:layout_constraintStart_toStartOf="parent"
            app:layout_constraintTop_toBottomOf="@id/titleBar">

            <!-- TextView for the task's description. -->
            <TextView
                android:id="@+id/taskDescription"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:textColor="@android:color/black"
                android:textSize="14sp"
                tools:text="This is the description of the task." />

            <!-- TextView for the task's deadline. Its visibility is controlled programmatically. -->
            <TextView
                android:id="@+id/taskDeadline"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginTop="8dp"
                android:textColor="#C62828"
                android:textSize="12sp"
                android:textStyle="bold|italic"
                tools:text="Deadline: 10/22/2025" />
        </LinearLayout>

    </androidx.constraintlayout.widget.ConstraintLayout>
</androidx.cardview.widget.CardView>
